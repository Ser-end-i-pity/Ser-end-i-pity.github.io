<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ser-end-i-pity.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.14.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/index.html">
<meta property="og:site_name" content="猫尛妖">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108183846003.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108183236472.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108183510267.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108192134838.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108194251903.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/style/study/MySQL/img/image-20221108194538050.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108194832940.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108195006302.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221109111005143.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221109171143965.png">
<meta property="og:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221209173931160.png">
<meta property="article:published_time" content="2022-12-20T05:55:53.000Z">
<meta property="article:modified_time" content="2022-12-20T06:40:02.762Z">
<meta property="article:author" content="猫尛妖">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ser-end-i-pity.github.io/2022/12/20/MySQL/image-20221108183846003.png">


<link rel="canonical" href="https://ser-end-i-pity.github.io/2022/12/20/MySQL/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ser-end-i-pity.github.io/2022/12/20/MySQL/","path":"2022/12/20/MySQL/","title":"MySQL"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL | 猫尛妖</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">猫尛妖</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">猫尛妖</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80-MySQL8-%E5%AE%89%E8%A3%85"><span class="nav-number">1.</span> <span class="nav-text">一 MySQL8 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-1-%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 下载压缩包</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-%E8%A7%A3%E5%8E%8B%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 解压与配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-3-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 初始化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-4-%E4%BD%BF%E7%94%A8-MySQL"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 使用 MySQL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-5-%E9%80%80%E5%87%BA-MySQL"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 退出 MySQL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-6-%E4%BF%AE%E6%94%B9%E5%8A%A0%E5%AF%86%E8%A7%84%E5%88%99"><span class="nav-number">1.6.</span> <span class="nav-text">1.6 修改加密规则</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">二 基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 创建数据库表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 数据库表列类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 添加数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-%E4%BF%AE%E6%94%B9-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">2.4.</span> <span class="nav-text">2.4  修改 , 删除数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-%E4%BF%AE%E6%94%B9-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 修改 , 删除数据库表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-6-%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 非外键约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 外键约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-8-DDL-%E5%92%8C-DML-%E7%9A%84%E8%A1%A5%E5%85%85"><span class="nav-number">2.8.</span> <span class="nav-text">2.8 DDL 和 DML 的补充</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89-DQL"><span class="nav-number">3.</span> <span class="nav-text">三 DQL</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-%E8%A1%A8%E7%9A%84%E5%87%86%E5%A4%87"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 表的准备</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-SQL-%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 SQL 查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3-where-%E5%AD%90%E5%8F%A5"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 where 子句</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B-%E5%87%BD%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">四 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-1-%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 函数的分类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-2-%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 单行函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-4-%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">4.3.</span> <span class="nav-text">4.4 多行函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-5-%E5%88%86%E7%BB%84-group-by"><span class="nav-number">4.4.</span> <span class="nav-text">4.5 分组 group by</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-6-having-%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89"><span class="nav-number">4.5.</span> <span class="nav-text">4.6 having 分组后筛选</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-7-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93"><span class="nav-number">4.6.</span> <span class="nav-text">4.7 单表查询总结</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%94-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.</span> <span class="nav-text">五 多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 内连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-%E4%B8%89%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 三表查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.4.</span> <span class="nav-text">5.4 自连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-5-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A292%E8%AF%AD%E6%B3%95"><span class="nav-number">5.5.</span> <span class="nav-text">5.5 多表查询92语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-6-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.6.</span> <span class="nav-text">5.6 子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#5-6-1-%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.6.1.</span> <span class="nav-text">5.6.1 单行子查询</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-6-2-%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.6.2.</span> <span class="nav-text">5.6.2 多行子查询</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-6-3-%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.6.3.</span> <span class="nav-text">5.6.3 相关子查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AD-%E4%BA%8B%E5%8A%A1"><span class="nav-number">6.</span> <span class="nav-text">六 事务</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#6-1-%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 事务的并发问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 事务的隔离级别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%83-%E8%A7%86%E5%9B%BE"><span class="nav-number">7.</span> <span class="nav-text">七 视图</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="猫尛妖"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">猫尛妖</p>
  <span style="color:#fff"><i class="fas fa-map-marker-alt"></i> 广东</span>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Ser-end-i-pity" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Ser-end-i-pity" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kang.time@qq.com" title="E-Mail → mailto:kang.time@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=3490891825&website=www.oicqzone.com" title="QQ → tencent:&#x2F;&#x2F;AddContact&#x2F;?fromId&#x3D;45&amp;fromSubId&#x3D;1&amp;subcmd&#x3D;all&amp;uin&#x3D;3490891825&amp;website&#x3D;www.oicqzone.com" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>

        </div>
      </div>
    </div>
    
	<div id="Date" style="color: #e5dfdf;margin-left: 10px;"></div>
	<script type="text/javascript"> 
		function showDate(){
		var w1 = ['日', '一', '二', '三', '四', '五', '六'];
		setInterval(function(){   
		var date=new Date();   
		var year=date.getFullYear(); //获取当前年份   
		var mon=date.getMonth()+1; //获取当前月份   
		var da=date.getDate(); //获取当前日   
		var day=w1[date.getDay()]; //获取当前星期几   
		var h=('0'+date.getHours()).slice(-2); //获取小时   
		var m=('0'+date.getMinutes()).slice(-2); //获取分钟   
		var s=('0'+date.getSeconds()).slice(-2); //获取秒 
		var d=document.getElementById('Date');    
		d.innerHTML='今天是'+year+'年'+mon+'月'+da+'日'+'星期'+day+' '+h+':'+m+':'+s;  },1000)  }
		showDate();
		</script>
	<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=335 src="//music.163.com/outchain/player?type=0&id=7708016601&auto=1&height=430"></iframe>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ser-end-i-pity.github.io/2022/12/20/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="猫尛妖">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="猫尛妖">
      <meta itemprop="description" content="Java">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL | 猫尛妖">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-20 13:55:53 13:55:53" itemprop="dateCreated datePublished" datetime="2022-12-20T13:55:53+08:00">2022-12-20 13:55:53</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-12-20 14:40:02 14:40:02" itemprop="dateModified" datetime="2022-12-20T14:40:02+08:00">2022-12-20 14:40:02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <img src="/2022/12/20/MySQL/image-20221108183846003.png" alt="image-20221108183846003">

<span id="more"></span>

<h4 id="一-MySQL8-安装"><a href="#一-MySQL8-安装" class="headerlink" title="一 MySQL8 安装"></a>一 MySQL8 安装</h4><p>近期主要历史版本有5.0/5.1/5.5/5.6/5.7，目前最新版本是MySQL8。</p>
<h5 id="1-1-下载压缩包"><a href="#1-1-下载压缩包" class="headerlink" title="1.1 下载压缩包"></a>1.1 下载压缩包</h5><ul>
<li><p>官网下载压缩包，<code>https://dev.mysql.com/downloads/mysql/</code>,如果需要可执行安装，亦可转到下载：<code>https://dev.mysql.com/downloads/windows/installer/8.0.html</code></p>
<p><img src="/2022/12/20/MySQL/image-20221108183236472.png" alt="image-20221108183236472"></p>
</li>
</ul>
<img src="/2022/12/20/MySQL/image-20221108183510267.png" alt="image-20221108183510267" style="zoom:200%;">

<h5 id="1-2-解压与配置"><a href="#1-2-解压与配置" class="headerlink" title="1.2 解压与配置"></a>1.2 解压与配置</h5><ol>
<li><p>解压到相应的目录</p>
<p>如个人目录为 : <code>D:\mysql-8.0.31-winx64</code></p>
</li>
<li><p>环境配置</p>
<p>在安装根目录下新建一个配置文件<code>MySql.ini</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[mysql]</span><br><span class="line"># 设置mysql客户端默认字符集</span><br><span class="line"><span class="keyword">default</span><span class="operator">-</span><span class="type">character</span><span class="operator">-</span><span class="keyword">set</span><span class="operator">=</span>utf8</span><br><span class="line"> </span><br><span class="line">[mysqld]</span><br><span class="line"># 设置<span class="number">3306</span>端口</span><br><span class="line">port <span class="operator">=</span> <span class="number">3306</span></span><br><span class="line"> </span><br><span class="line"># 设置mysql的安装目录</span><br><span class="line">basedir<span class="operator">=</span>&quot;D:\mysql-8.0.31-winx64&quot;</span><br><span class="line"> </span><br><span class="line"># 设置mysql数据库的数据的存放目录</span><br><span class="line">datadir<span class="operator">=</span>&quot;D:\mysql-8.0.31-winx64\data&quot;</span><br><span class="line"> </span><br><span class="line"># 允许最大连接数</span><br><span class="line">max_connections<span class="operator">=</span><span class="number">20</span>  </span><br><span class="line"> </span><br><span class="line"># 服务端使用的字符集默认为<span class="number">8</span>比特编码的latin1字符集</span><br><span class="line"><span class="type">character</span><span class="operator">-</span><span class="keyword">set</span><span class="operator">-</span>server<span class="operator">=</span>utf8</span><br><span class="line"> </span><br><span class="line"># 创建新表时将使用的默认存储引擎</span><br><span class="line"><span class="keyword">default</span><span class="operator">-</span>storage<span class="operator">-</span>engine<span class="operator">=</span>INNODB</span><br></pre></td></tr></table></figure></li>
<li><p>设置系统环境变量</p>
<p> 将MySql的<code>bin</code>目录加到系统环境变量**<code>path</code>**</p>
</li>
</ol>
<h5 id="1-3-初始化"><a href="#1-3-初始化" class="headerlink" title="1.3 初始化"></a>1.3 初始化</h5><ul>
<li><p>空密码生成</p>
<p>在cmd窗口中执行：<code>mysqld --initialize-insecure --console</code>，<strong>注意：</strong>缺少参数<code>-insecure</code>会生成随即密码。 如果缺少必要的VC库，进行安装即可。</p>
</li>
<li><p>注册安装 MySQL</p>
<p>继续在cmd窗口中执行 <code>mysqld install mysql</code></p>
<p>​    其他与之相关的操作:</p>
<p>​        <strong>卸载mysql服务(需要管理员权限)</strong></p>
<p>​            sc delete mysql </p>
<p>​        <strong>移除mysql服务(需要停止mysql)</strong></p>
<p>​            mysql -remove</p>
<p>​    最后在cmd窗口中能看到 Service successfully installed.  就表示初始化成功</p>
</li>
</ul>
<h5 id="1-4-使用-MySQL"><a href="#1-4-使用-MySQL" class="headerlink" title="1.4 使用 MySQL"></a>1.4 使用 MySQL</h5><ul>
<li><p>启动 MySQL</p>
<p><code>net start mysql</code> ,如需关闭MySql，则执行 <code>net stop mysql</code></p>
</li>
<li><p>登录 MySQL</p>
<p><code>mysql -uroot</code></p>
</li>
<li><p>密码设置</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> 切换数据库</span><br><span class="line">   use mysql</span><br><span class="line"> </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> 修改root用户的密码为,根据需要自己来设置</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;root&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>刷新权限,一般修改密码或授权用户的时候需要使用</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="1-5-退出-MySQL"><a href="#1-5-退出-MySQL" class="headerlink" title="1.5 退出 MySQL"></a>1.5 退出 MySQL</h5><p><code>quit</code> 或者 <code>exit</code> 均可</p>
<h5 id="1-6-修改加密规则"><a href="#1-6-修改加密规则" class="headerlink" title="1.6 修改加密规则"></a>1.6 修改加密规则</h5><p>MySQL8 以前的加密规则与 MySQL8 以后的存在差异</p>
<p> mysql服务启动后,输入命令**:**mysql -uroot -p****进入服务后 , 输入以下命令配置 :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span> PASSWORD EXPIRE NEVER; #修改加密规则</span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;  # 更新一下用户的密码 <span class="comment">--&gt;&#x27;password&#x27;根据需要设置密码</span></span><br><span class="line"> </span><br><span class="line">FLUSH PRIVILEGES; #刷新权限</span><br></pre></td></tr></table></figure>

<p>成功后在 SQLyog中 输入修改后的密码即可登录啦</p>
<h4 id="二-基本操作"><a href="#二-基本操作" class="headerlink" title="二 基本操作"></a>二 基本操作</h4><p><strong>SQL 语言分为五部分 :</strong></p>
<p>●数据查询语言(Data Query Language, DQL) : DQL主要用于数据的查询，其基本结构是使用SELECT子句，FROM子句和WHERE子句</p>
<p>的组合来查询一条或多条数据。</p>
<ul>
<li>数据操作语言(Data Manipulation Language, DML) : DML主要用于对数据库中的数据进行增加、修改和删除的操作，其主要包括:</li>
</ul>
<p>​        INSERT:增加数据</p>
<p>​        UPDATE:修改数据</p>
<p>​        DELETE:删除数据</p>
<ul>
<li>数据定义语言(Data Definition Language, DDL) : DDL主要用针对是数据库对象(数据库、表、索引、视图、触发器、存储过程、函数)进行创建、修改和删除操作。其主要包括:</li>
</ul>
<p>​        CREATE:创建数据库对象</p>
<p>​        ALTER:修改数据库对象</p>
<p>​        DROP:删除数据库对象</p>
<ul>
<li><p>数据控制语言(Data Control Language, DCL) : DCL用来授予或回收访问数据库的权限，其主要包括:</p>
<ol>
<li>GRANT:授予用户某种权限</li>
<li>REVOKE:回收授予的某种权限</li>
</ol>
</li>
<li><p>事务控制语言(Transaction Control Language, TCL) : TCL用于数据库的事务管理。其主要包括:</p>
<ol>
<li>START TRANSACTION:开启事务</li>
</ol>
<ol start="2">
<li><p>COMMIT:提交事务</p>
</li>
<li><p>ROLLBACK:回滚事务</p>
</li>
<li><p>SET TRANSACTION:设置事务的属性</p>
</li>
</ol>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases; <span class="comment">-- 查看数据库</span></span><br><span class="line">use 数据库名字; <span class="comment">-- 使用数据库</span></span><br><span class="line"><span class="keyword">show</span> tables; <span class="comment">-- 查看数据库表</span></span><br></pre></td></tr></table></figure>



<h5 id="2-1-创建数据库表"><a href="#2-1-创建数据库表" class="headerlink" title="2.1 创建数据库表"></a>2.1 创建数据库表</h5><p><strong>表(Table)</strong> 是数据库中数据存储最常见和最简单的一-种形式，数据库可以将复杂的数据结构用较为简单的二维表来表示。=维表是由行和列组成的，分别都包含着数据，如表所示。</p>
<img src="/2022/12/20/MySQL/image-20221108192134838.png" alt="image-20221108192134838" style="zoom:200%;">

<p>每个表都是由若干行和列组成的，在数据库中表中的行被称为记录，表中的列被称为是这些记录的字段。<br>记录也被称为一行数据，是表里的一行。 在关系型数据库的表里, - -行数据是指一条完整的记录。<br>字段是表里的一列，用于保存每条记录的特定信息。如上表所示的学生信息表中的字段包括”学号”、”姓名”、 “性别”和 “年龄”。数据表的一列包含了某个特定字段的全部信息。</p>
<p><strong>创建数据库表 t_student</strong></p>
<ul>
<li>建立- -张用来存储学生信息的表</li>
<li>字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</li>
<li>学号是主键=不能为空+唯一</li>
<li>姓名不能为空</li>
<li>性别默认值是男</li>
<li>Email唯一</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">## 单行注释</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- 创建数据库表 :</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span>(<span class="number">6</span>), <span class="comment">-- 6 显示长度</span></span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">10</span>), <span class="comment">-- 10 个字符</span></span><br><span class="line">	sex <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">	age <span class="type">INT</span>(<span class="number">3</span>),</span><br><span class="line">	enterdate <span class="type">DATE</span>,</span><br><span class="line">	classname <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	email <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表结构 : 展示表的字段详细信息</span></span><br><span class="line"><span class="keyword">DESC</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表中数据 :</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看建表语句 :</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">CREATE TABLE `t_student` (</span></span><br><span class="line"><span class="comment">  `sno` INT DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `sname` VARCHAR(10) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `sex` CHAR(1) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `age` INT DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `enterdate` DATE DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `classname` VARCHAR(10) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `email` VARCHAR(15) DEFAULT NULL</span></span><br><span class="line"><span class="comment">) ENGINE=INNODB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h5 id="2-2-数据库表列类型"><a href="#2-2-数据库表列类型" class="headerlink" title="2.2 数据库表列类型"></a>2.2 数据库表列类型</h5><ol>
<li><p>整数类型</p>
<img src="/2022/12/20/MySQL/image-20221108194251903.png" alt="image-20221108194251903" style="zoom:200%;"></li>
</ol>
<p>​    MySQL支持选择在该类型关键字后面的括号内指定整数值的显示宽度(例如，INT(4))。 显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示主键自增:不使用序列，通过 <code>auto_ increment</code>,要求是整数类型</p>
<ol start="2">
<li> 浮点数类型</li>
</ol>
<p>​    <img src="/2022/12/20/MySQL/style\study\MySQL\img\image-20221108194538050.png" alt="image-20221108194538050" style="zoom:150%;"></p>
<ol start="3">
<li>字符串类型</li>
</ol>
<p>​    需要注意的是与整数类型不一样的是，浮点数类型的宽度不会自动扩充。score double(4,1)</p>
<p>score double(4,1)–小数部分为1位，总宽度4位,并且不会自动扩充。</p>
<img src="/2022/12/20/MySQL/image-20221108194832940.png" alt="image-20221108194832940" style="zoom:200%;">

<p>CHAR和VARCHAR类型相似，均用于存于较短的字符串,主要的不同之处在于存储方式。CHAR类型长度固定，VARCHAR类型的长度可变。<br>因为VARCHAR类型能够根据字符串的实际长度来动态改变所占字节的大小，所以在不能明确该字段具体需要多少字符时推荐使用VARCHAR类型，这样可以大大地节约磁盘空间、提高存储效率。<br>CHAR和VARCHAR表示的是字符的个数，而不是字节的个数</p>
<ol start="4">
<li><p>日期和时间类型</p>
<img src="/2022/12/20/MySQL/image-20221108195006302.png" alt="image-20221108195006302" style="zoom:200%;"></li>
</ol>
<h5 id="2-3-添加数据"><a href="#2-3-添加数据" class="headerlink" title="2.3 添加数据"></a>2.3 添加数据</h5><blockquote>
<ol>
<li><p>int宽度是显示宽度,如果超过,可以自动增大宽度int底层都是4个字节</p>
</li>
<li><p>时间的方式多样’1256-12-23’ “1256/12/23” “1256.12.23”</p>
</li>
<li><p>字符串不区分单引号和双引号</p>
</li>
<li><p>如何写入当前的时间now() , sysdate() , CURRENT_ DATE()</p>
</li>
<li><p>char varchar是字符的个数,不是字节的个数，可以使用binary, varbinany表示定长和不定长的字节个数。</p>
</li>
<li><p>如果不是全字段插入数据的话, 需要加入字段的名字。</p>
</li>
</ol>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看表记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在t_student 数据库表中插入数据:</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,&quot;2022-5-16&quot;,<span class="string">&#x27;物联网工程&#x27;</span>,&quot;1203@126.com&quot;);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="number">10086</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,&quot;2022.5.26&quot;,<span class="string">&#x27;物联网工程&#x27;</span>,&quot;1203@126.com&quot;);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="number">55</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,NOW(),<span class="string">&#x27;物联网工程&#x27;</span>,&quot;1203@126.com&quot;);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student (sno,sname,enterdate) <span class="keyword">VALUES</span> (<span class="number">1006</span>,<span class="string">&#x27;赵六&#x27;</span>,&quot;2023.3.15&quot;);</span><br></pre></td></tr></table></figure>



<h5 id="2-4-修改-删除数据"><a href="#2-4-修改-删除数据" class="headerlink" title="2.4  修改 , 删除数据"></a>2.4  修改 , 删除数据</h5><ol>
<li>关键字，表名，字段名不区分大小写</li>
<li>默认情况下，内容不区分大小写</li>
<li>删除操作from关键字不可缺少</li>
<li>修改， 删除数据别忘记加限制条件</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改表中数据</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_student <span class="keyword">SET</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span> <span class="keyword">WHERE</span> sno <span class="operator">=</span><span class="number">55</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> t_student <span class="keyword">SET</span> age <span class="operator">=</span> <span class="number">21</span> <span class="keyword">WHERE</span> sno <span class="operator">=</span> <span class="number">1006</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除操作</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> sno <span class="operator">=</span> <span class="number">1</span> ;</span><br></pre></td></tr></table></figure>



<h5 id="2-5-修改-删除数据库表"><a href="#2-5-修改-删除数据库表" class="headerlink" title="2.5 修改 , 删除数据库表"></a>2.5 修改 , 删除数据库表</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看数据 :</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改表的结构:</span></span><br><span class="line"><span class="comment">-- 增加一列 :</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> score <span class="keyword">DOUBLE</span>(<span class="number">5</span>,<span class="number">2</span>); <span class="comment">-- 5 : 总位数  2 : 小数位</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_student <span class="keyword">SET</span> score <span class="operator">=</span> <span class="number">123.5678</span> <span class="keyword">WHERE</span> sno <span class="operator">=</span> <span class="number">55</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增加一列 (放在最前面)</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> score <span class="keyword">DOUBLE</span>(<span class="number">5</span>,<span class="number">2</span>) <span class="keyword">FIRST</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增加一列 (放在sex列的后面)</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> score <span class="keyword">DOUBLE</span>(<span class="number">5</span>,<span class="number">2</span>) AFTER sex;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除一列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">DROP</span> score;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改一列:</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student MODIFY score <span class="type">FLOAT</span>(<span class="number">4</span>,<span class="number">1</span>); <span class="comment">-- modify修改是列的类型的定义,但是不会改变列的名字</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student CHANGE score score1 <span class="keyword">DOUBLE</span> (<span class="number">5</span>,<span class="number">1</span>); <span class="comment">-- change 修改列名和列的类型的定义</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除表</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> t_student;</span><br></pre></td></tr></table></figure>



<h5 id="2-6-非外键约束"><a href="#2-6-非外键约束" class="headerlink" title="2.6 非外键约束"></a>2.6 非外键约束</h5><p>为防止不符合规范的数据存入数据库，在用户对数据进行插入、修改、删除等操作时，MySQL提供了一-种机制来检查数据库中的数据是否满足规定的条件，以保证数据库中数据的准确性和一致性，这种机制就是完整性约束。<br>MySQL中主要支持以下几种种完整性约束，如表所示。其中Check约束是MySQL8中提供的支持。</p>
<img src="/2022/12/20/MySQL/image-20221109111005143.png" alt="image-20221109111005143" style="zoom:150%;">

<blockquote>
<p>建立一张用来存储学生信息的表<br>字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息<br>约束:<br>建立一张用来存储学生信息的表<br>字段包含学号、姓名、性别，年龄、入学日期、班级，email等信 息</p>
<ol>
<li>学号是主键=不能为空+唯一，</li>
<li>如果主键是整数类型，那么需要自增</li>
<li>姓名不能为空</li>
<li>Email唯一</li>
<li>性别默认值是男</li>
<li>性别只能是男女</li>
<li>年龄只能在18-50之间</li>
</ol>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span>(<span class="number">6</span>) <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">5</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	sex <span class="type">CHAR</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">CHECK</span>(sex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">	age <span class="type">INT</span>(<span class="number">3</span>) <span class="keyword">CHECK</span>(age<span class="operator">&gt;=</span><span class="number">18</span> <span class="keyword">AND</span> age<span class="operator">&lt;=</span><span class="number">50</span>),</span><br><span class="line">	enterdate <span class="type">DATE</span>,</span><br><span class="line">	classname <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	email <span class="type">VARCHAR</span>(<span class="number">15</span>) <span class="keyword">UNIQUE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2023.3.6&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;10086A@126.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1048 - Column sname’cannot be null 不能为null</span></span><br><span class="line"><span class="comment">-- 3819 Check constraint&#x27;t_student_chk_l&#x27; is violated. 违反检查约束</span></span><br><span class="line"><span class="comment">-- 1062 - Duplicate entry &#x27;1&#x27; for key &#x27;t_ student . PRIMARY&#x27;主键重复</span></span><br><span class="line"><span class="comment">-- 1062 Duplicate entry &#x27;ls@126. com&#x27; for key &#x27;t_ student.email&#x27;违反唯一约束</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果主键没有设定值，或者用null, default都可以完成主键自增的效果</span></span><br><span class="line"><span class="comment">-- 如果sql报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2023.3.6&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;10086A@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="keyword">default</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2023.3.6&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;10086A@126.com&#x27;</span>);</span><br></pre></td></tr></table></figure>



<p>约束从作用上可以分为两类:</p>
<ul>
<li>表级约束: 可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中;与定义用’, ‘分隔;必须指出要约束的列的名称;</li>
<li>列级约束: 包含在列定义中,直接跟在该列的其它定义之后，用空格分隔;不必指定列名; </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span>(<span class="number">6</span>) AUTO_INCREMENT,</span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">5</span>),</span><br><span class="line">	sex <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">	age <span class="type">INT</span>(<span class="number">3</span>),</span><br><span class="line">	enterdate <span class="type">DATE</span>,</span><br><span class="line">	classname <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	email <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> pk_stu <span class="keyword">PRIMARY</span> KEY (sno), <span class="comment">-- pk_stu 主键约束的名字</span></span><br><span class="line">	<span class="keyword">CONSTRAINT</span> ck_stu_sex <span class="keyword">CHECK</span> (sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> ck_stu_age <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">50</span>),</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> uq_stu_email <span class="keyword">UNIQUE</span> (email)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2023.3.6&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;10086A@126.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2023.3.6&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;10086@qq.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br></pre></td></tr></table></figure>



<p><strong>在创建表以后添加约束</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span>,</span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">5</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	sex <span class="type">CHAR</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">	age <span class="type">INT</span>,</span><br><span class="line">	enterdate <span class="type">DATE</span>,</span><br><span class="line">	classname <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	email <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在创建表以后添加约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_stu <span class="keyword">PRIMARY</span> KEY (sno); <span class="comment">-- 主键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student MODIFY sno <span class="type">INT</span>(<span class="number">6</span>) AUTO_INCREMENT; <span class="comment">-- 修改自增条件</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ck_stu_sex <span class="keyword">CHECK</span> (sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ck_stu_age <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">50</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> uq_stu_email <span class="keyword">UNIQUE</span> (email);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表的结构</span></span><br><span class="line"><span class="keyword">DESC</span> t_student;</span><br></pre></td></tr></table></figure>



<h5 id="2-7-外键约束"><a href="#2-7-外键约束" class="headerlink" title="2.7 外键约束"></a>2.7 外键约束</h5><ul>
<li>什么是外键约束?</li>
</ul>
<p>​    外键约束(FOREIGN KEY,缩写FK)是用来实现数据库表的参照完整性    的。外键约束可以使两张表紧密的结合起来，特别是针对修改或者删    除的级联操作时，会保证数据的完整性。</p>
<ul>
<li>外键是指表中某个字段的值依赖于另- -张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯- -约束。被依赖的表我们通常称之为父表或者主表,设置外键约束的表称为子表或者从表。</li>
<li>举个例子:如果想要表示学生和班级的关系,首先要有学生表和班级表两张表，然后学生表中有个字段为stu_ clazz (该字段表示学生所在的班级)，而该字段的取值范围由班级表中的主键cla_ no字段(该字段表示班级编号)的取值决定。那么班级表为主表，学生表为从表，且stu_ <em>clazz字段是学生表的外键。通过stu</em> clazz字段就建立了学生表和班级表的关系。</li>
</ul>
<img src="/2022/12/20/MySQL/image-20221109171143965.png" alt="image-20221109171143965" style="zoom:200%;">

<p>主表(父表) : 班级表 - 班级编号 - 主键<br>从表(子表) : 学生表 - 班级编号 - 外键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先创建父表 : 班级表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_class(</span><br><span class="line">	cno <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	cname <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	room <span class="type">CHAR</span>(<span class="number">4</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加班级数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_class <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;java001&#x27;</span>,<span class="string">&#x27;r803&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_class <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;java002&#x27;</span>,<span class="string">&#x27;r403&#x27;</span>`t_student`);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_class <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;大数据&#x27;</span>,<span class="string">&#x27;r103&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 可以一次性添加多条记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_class <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;java001&#x27;</span>,<span class="string">&#x27;r803&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;java002&#x27;</span>,<span class="string">&#x27;r403&#x27;</span>`t_student`),(<span class="keyword">NULL</span>,<span class="string">&#x27;大数据&#x27;</span>,<span class="string">&#x27;r103&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询班级表</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_class;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建子表 外键约束只有表级约束,没有列级约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">5</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	classno <span class="type">INT</span>(<span class="number">4</span>), <span class="comment">-- 取值参考t_class 表中的cno 字段,不要求字段名字完全重复,但是类型长度定义 尽量要求相同</span></span><br><span class="line">	<span class="keyword">CONSTRAINT</span> fk_stu_classno <span class="keyword">FOREIGN</span>  KEY (classno) <span class="keyword">REFERENCES</span> t_class(cno)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student(</span><br><span class="line">	sno <span class="type">INT</span>(<span class="number">6</span>) <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">5</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	classno <span class="type">INT</span>(<span class="number">4</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 在创建表以后添加外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stu_classno <span class="keyword">FOREIGN</span> KEY (classno) <span class="keyword">REFERENCES</span> t_class(cno);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加学生信息</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_student <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">1</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">1</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除班级1</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_class <span class="keyword">WHERE</span> cno <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 先删除主表 , 再删除从表。</span></span><br></pre></td></tr></table></figure>



<p><strong>外键策略</strong></p>
<p>删除班级1 : 如果直接删除的话肯定不行因为有外键约束:</p>
<p>加入外键策略:</p>
<p>**策略 1 : no action ** 不允许操作</p>
<p>通过操作sql 来完成:</p>
<p>先把班级1 的学生对应的班级 改为 null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_class;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"><span class="comment">-- 先把班级2的学生对应的班级 改为 null</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_student <span class="keyword">SET</span> classno <span class="operator">=</span> <span class="keyword">NULL</span> <span class="keyword">WHERE</span> classno <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 然后再删除班级2</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_class <span class="keyword">WHERE</span> cno <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>



<p>**策略 2 : cascade 级联操作 ** 操作主表的时候影响从表的外键信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先删除之前的外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_stu_classno;</span><br><span class="line"><span class="comment">-- 重新添加外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stu_classno <span class="keyword">FOREIGN</span> KEY (classno) <span class="keyword">REFERENCES</span> t_class(cno) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br><span class="line"><span class="comment">-- 试试更新</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_class <span class="keyword">SET</span> cno <span class="operator">=</span> <span class="number">5</span> <span class="keyword">WHERE</span> cno <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 试试删除</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_class <span class="keyword">WHERE</span> cno <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<p>**策略 3 : set null ** 置空操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_class;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"><span class="comment">-- 先删除之前的外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_stu_classno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重新添加外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stu_classno <span class="keyword">FOREIGN</span> KEY (classno) <span class="keyword">REFERENCES</span> t_class(cno) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 试试更新</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_class <span class="keyword">SET</span> cno <span class="operator">=</span> <span class="number">5</span> <span class="keyword">WHERE</span> cno <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>



<p><strong>注意 :</strong> </p>
<ol>
<li>策略2 级联操作 和 策略 3 的删除操作 可以混着使用 <code>ON UPDATE CASCADE ON DELETE SET NULL</code> ;</li>
<li>应用场合 :<ul>
<li>朋友圈删除,点赞。留言都删除 – 级联操作</li>
<li>解散班级,对应的学生置为null就可以了 – set null</li>
</ul>
</li>
</ol>
<h5 id="2-8-DDL-和-DML-的补充"><a href="#2-8-DDL-和-DML-的补充" class="headerlink" title="2.8 DDL 和 DML 的补充"></a>2.8 DDL 和 DML 的补充</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加一张表 : 快速添加 : 结构和数据跟t_student 都是一致的</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student2;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加一张表 : 快速添加 : 结构跟t_student , 不需要数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 快速添加 : 只要部分列 , 部分数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_student4</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sno,sname <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> sno <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除数据操作 : 清空数据</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_student;</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> t_student;</span><br></pre></td></tr></table></figure>

<p><strong>delete和truncate的区别 :</strong><br>从最终的结果来看，虽然使用TRUNCATE操作和使用DELETE操作都可以删除表中的全部记录,但是两者还是有很多区别的，其区别主要体现在以下几个方面:</p>
<ol>
<li>DELETE为数据操作语言DML; TRUNCATE为数据定义语言DDL。</li>
<li>DELETE操作是将表中所有记录-条-条删除直到删除完; TRUNCATE操作则是保留了表的结构，重新创建了这个表，所有的状态都相当于新表。因此，TRUNCATE操作的效率更高。</li>
<li>DELETE操作可以回滚; TRUNCATE操作会导致隐式提交，因此不能回滚(在第+章中会讲解事务的提交和回滚)。</li>
<li>DELETE操作执行成功后会返回已删除的行数(如删除4行记录,则会显示”Affected rows: 4” ) ;截断操作不会返回已删除的行量，结果通常是”Affected rows: 0”。DELETE操作删除表中记录后，再次向表中添加新记录时，对于设置有自增约束字段的值会从删除前表中该字段的最大值加1开始自增; TRUNCATE操作则会重新从1开始自增。</li>
</ol>
<h4 id="三-DQL"><a href="#三-DQL" class="headerlink" title="三 DQL"></a>三 DQL</h4><h5 id="3-1-表的准备"><a href="#3-1-表的准备" class="headerlink" title="3.1 表的准备"></a>3.1 表的准备</h5><p>准备四张表 : dept(部门表) , emp(员工表) , salgrade(薪资等级表), bonus(奖金表)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">USE db;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DEPT(</span><br><span class="line">	DEPTNO <span class="type">INT</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">	DNAME <span class="type">VARCHAR</span>(<span class="number">14</span>),</span><br><span class="line">	LOC <span class="type">VARCHAR</span>(<span class="number">13</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> dept</span><br><span class="line">	<span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_dept <span class="keyword">PRIMARY</span> KEY (deptno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> EMP</span><br><span class="line">(</span><br><span class="line">	EMPNO <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	ENAME <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	JOB <span class="type">VARCHAR</span>(<span class="number">9</span>),</span><br><span class="line">	MGR <span class="type">INT</span>(<span class="number">4</span>),</span><br><span class="line">	HIREDATE <span class="type">DATE</span>,</span><br><span class="line">	SAL <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">	COMM <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">	DEPTNO <span class="type">INT</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> EMP</span><br><span class="line">	<span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_DEPTINO <span class="keyword">FOREIGN</span> KEY (DEPTNO)</span><br><span class="line">	<span class="keyword">REFERENCES</span> DEPT (DEPTNO);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SALGRADE</span><br><span class="line">(</span><br><span class="line">	GRADE <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	LOSAL <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">	HISAL <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> BONUS</span><br><span class="line">(</span><br><span class="line">	ENAME <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	J0B <span class="type">VARCHAR</span>(<span class="number">9</span>),</span><br><span class="line">	SAL <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">	COMM <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT (DEPTNO, DNAME, LOC)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT (DEPTNO, DNAME, LOC)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">20</span>,<span class="string">&#x27; RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span> );</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT (DEPTNO, DNAME, LOC)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT (DEPTNO, DNAME, LOC)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27; BOSTON&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">7369</span>, <span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7902</span>, <span class="string">&#x27;1980-12-17&#x27;</span>,<span class="number">800</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7499</span>,<span class="string">&#x27;ALL EN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1981-02-20&#x27;</span>,<span class="number">1600</span>,<span class="number">300</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7521</span>,<span class="string">&#x27;WARD&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-02-22&#x27;</span>, <span class="number">1250</span>, <span class="number">500</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7566</span>,<span class="string">&#x27;JONES&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1981-04-02&#x27;</span>, <span class="number">2975</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7654</span>,<span class="string">&#x27;MARTIN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-09-28&#x27;</span>, <span class="number">1250</span>, <span class="number">1400</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7698</span>, <span class="string">&#x27;BLAKE&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>, <span class="string">&#x27; 1981-05-01&#x27;</span>, <span class="number">2850</span>, <span class="keyword">NULL</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7782</span>, <span class="string">&#x27;CLARK&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1981-06-09&#x27;</span>, <span class="number">2450</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span>	(<span class="number">7788</span>,<span class="string">&#x27;SCOTT&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>, <span class="string">&#x27;1987-04-19&#x27;</span>, <span class="number">3000</span>,<span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7839</span>,<span class="string">&#x27;KING&#x27;</span>, <span class="string">&#x27;PRESIDENT&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;1981-11-17&#x27;</span>, <span class="number">5000</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7844</span>,<span class="string">&#x27;TURNER&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-09-08&#x27;</span>, <span class="number">1500</span>, <span class="number">0</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7876</span>,<span class="string">&#x27;ADAMS&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7788</span>, <span class="string">&#x27;1987-05-23&#x27;</span>, <span class="number">1100</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7900</span>, <span class="string">&#x27;AMES&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-12-03&#x27;</span>, <span class="number">950</span>, <span class="keyword">NULL</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7902</span>,<span class="string">&#x27;FORD&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>,<span class="string">&#x27;1981-12-03&#x27;</span>, <span class="number">3000</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP (EMPNO, ENAME,JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)</span><br><span class="line">	<span class="keyword">VALUES</span> 	(<span class="number">7934</span>,<span class="string">&#x27;MILLER&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7782</span>, <span class="string">&#x27;1982-01-23&#x27;</span>, <span class="number">1300</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line">	</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SALGRADE (GRADE, LOSAL, HISAL)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">700</span>,<span class="number">1200</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SALGRADE (GRADE, LOSAL, HISAL)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="number">1201</span>, <span class="number">1400</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SALGRADE (GRADE, LOSAL, HISAL)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">1401</span>, <span class="number">2000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SALGRADE (GRADE, LOSAL, HISAL)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="number">2001</span>, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SALGRADE (GRADE, LOSAL, HISAL)</span><br><span class="line">	<span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="number">3001</span>, <span class="number">9999</span>);</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 部门表: dept:department 部分，loc - location 位置</span></span><br><span class="line"><span class="comment">--员工表: emp:employee 员工 , mgr :manager上级领导编号， hiredate 入职日期 firedate 解雇日期，common: 补助</span></span><br><span class="line"><span class="comment">-- deptno 外键参考 dept - deptno字段</span></span><br><span class="line"><span class="comment">-- mgr外键参考自身表 emp.empno 产生了自关联</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> salgrade;</span><br><span class="line"><span class="comment">-- losal - lowsal</span></span><br><span class="line"><span class="comment">-- hisal - highsal</span></span><br></pre></td></tr></table></figure>



<h5 id="3-2-SQL-查询"><a href="#3-2-SQL-查询" class="headerlink" title="3.2 SQL 查询"></a>3.2 SQL 查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 对 emp 表查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp; <span class="comment">-- * 代表所有数据</span></span><br><span class="line"><span class="comment">-- 显示部分列</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, sal <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 显示部分行 : where 子句</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="comment">-- 显示部分列 , 部分行 :</span></span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,job,mgr <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span><span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 起别名</span></span><br><span class="line"><span class="keyword">SELECT</span> empno 员工编号, ename 姓名,sal 工资 <span class="keyword">FROM</span> emp; <span class="comment">-- as省略，&#x27;&#x27;或者&quot;&quot;省略 了</span></span><br><span class="line"><span class="comment">-- as alias别名</span></span><br><span class="line"><span class="keyword">SELECT</span> empno <span class="keyword">AS</span> 员工编号,ename <span class="keyword">AS</span> 姓名,sal <span class="keyword">AS</span> 工资 <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> empno <span class="keyword">AS</span> <span class="string">&#x27;员工编号&#x27;</span>,ename <span class="keyword">AS</span> &quot;姓名&quot;,sal <span class="keyword">AS</span> 工资 <span class="keyword">FROM</span> emp ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 算术运算符</span></span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,sal,sal<span class="operator">+</span><span class="number">1000</span> <span class="keyword">AS</span> <span class="string">&#x27;涨薪后&#x27;</span>, deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&lt;</span> <span class="number">2500</span>;</span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,sal,comm,sal<span class="operator">+</span>comm <span class="keyword">FROM</span> emp;</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 去重操作</span></span><br><span class="line"><span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> job, deptno <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job, deptno <span class="keyword">FROM</span> emp; <span class="comment">-- 对后面的所有列组合去重，而不是单独的某一列去重</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal; <span class="comment">-- 默认情况下是按照升序排列的</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">ASC</span>; <span class="comment">-- asc 升序 ,可以默认不写</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">DESC</span>; <span class="comment">-- desc 降序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">ASC</span> , deptno <span class="keyword">DESC</span>; <span class="comment">-- 在工资升序的情况下，deptno按照降序排列</span></span><br></pre></td></tr></table></figure>



<h5 id="3-3-where-子句"><a href="#3-3-where-子句" class="headerlink" title="3.3 where 子句"></a>3.3 where 子句</h5><p>指定查询条件使用where子句，可以查询符合条件的部分记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- where子句:将过滤条件放在where子句的后面，可以筛选/过滤出我们想要的符合条件的数据:</span></span><br><span class="line"><span class="comment">-- where子句+关系运算符</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">&gt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">&gt;=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">&lt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">&lt;=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">&lt;&gt;</span> <span class="number">10</span>; <span class="comment">-- 不等于</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">!=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;clerk&#x27;</span>; <span class="comment">-- 默认情况下不区分大小写</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> <span class="type">BINARY</span> job <span class="operator">=</span> <span class="string">&#x27;clerk&#x27;</span>; <span class="comment">-- binary 区分大小写</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> hiredate <span class="operator">&lt;</span> <span class="string">&#x27;1981-12-25&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="keyword">where</span>子句<span class="operator">+</span>逻辑运算符: <span class="keyword">and</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="keyword">AND</span> sal <span class="operator">&lt;</span> <span class="number">3000</span>; <span class="comment">-- (1500 , 3000)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="operator">&amp;&amp;</span> sal <span class="operator">&lt;</span> <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="keyword">AND</span> sal <span class="operator">&lt;</span> <span class="number">3000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="keyword">BETWEEN</span> <span class="number">1500</span> <span class="keyword">AND</span> <span class="number">3000</span>; <span class="comment">-- [ 1500 , 3000]</span></span><br><span class="line"></span><br><span class="line"># <span class="keyword">where</span>子句<span class="operator">+</span>逻辑运算符: <span class="keyword">or</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span> <span class="keyword">OR</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span><span class="operator">||</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="keyword">IN</span> (<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="keyword">IN</span> ( <span class="string">&#x27;MANAGER&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span> , <span class="string">&#x27;ANALYST&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- where子句+模糊查询:</span></span><br><span class="line"><span class="comment">-- 查询名字中带A的员工 -- %代表任意多个字符0,1,2,</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;%A%&#x27;</span>;</span><br><span class="line"><span class="comment">-- 任意一个字符</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;_A%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关于null的判断:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> comm <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> comm <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 小括号的使用: 因为不同的运算符的优先级别不同，加括号为了可读性</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">OR</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">AND</span> sal <span class="operator">&gt;=</span><span class="number">1500</span>; <span class="comment">-- 先and再or and &gt; or</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">OR</span> (job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">AND</span> sal <span class="operator">&gt;=</span><span class="number">1500</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> (job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">OR</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>) <span class="keyword">AND</span> sal <span class="operator">&gt;=</span> <span class="number">1500</span>;</span><br></pre></td></tr></table></figure>



<h4 id="四-函数"><a href="#四-函数" class="headerlink" title="四 函数"></a>四 函数</h4><h5 id="4-1-函数的分类"><a href="#4-1-函数的分类" class="headerlink" title="4.1 函数的分类"></a>4.1 函数的分类</h5><p>MySQL中提供了大量函数来简化用户对数据库的操作，比如字符串的处理、日期的运算、数值的运算等等。使用函数可以大大提高SELECT语句操作数据库的能力，同时也给数据的转换和处理提供了方便。(在sql 中使用函数)<br>函数只是对查询结果中的数据进行处理，不会改变数据库中数据表的值。MySQL中的函数主要分为单行函数和多行函数两大类。</p>
<p><strong>单行函数</strong></p>
<p>单行函数是指对每一条记录输入值进行计算, 并得到相应的计算结果,然后返回给用户，也就是说，每条记录作为一个输入参数,经过函数计<br>算得到每条记录的计算结果。<br>常用的单行函数主要包括字符串函数、数值函数、日期与时间函数、流程函数以及其他函数。</p>
<p><strong>多行函数</strong></p>
<p>多行函数是指对一组数据进行运算,针对这一组数据 (多行记录)只返回一个结果，也称为分组函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 函数举例:</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, <span class="built_in">LOWER</span>( ename) , <span class="built_in">UPPER</span>(ename),sal <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 函数的功能:封装了特定的一些功能，我们直接拿过来使用，可以实现对应的功能</span></span><br><span class="line"><span class="comment">-- 函数作用:为了提高select的能力</span></span><br><span class="line"><span class="comment">-- 注意:函数没有改变数据自身的值，而是在真实数据的.上面进行加工处理，展示新的结果而己。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) , <span class="built_in">MIN</span>(sal), <span class="built_in">COUNT</span>(sal), <span class="built_in">SUM</span>(sal),<span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- lower(ename) , upper(ename): 改变每一条结果，每一条数据对应一条结果 单行函数</span></span><br><span class="line"><span class="comment">-- max(sal) ,min(sal), count(sa1), sum(sal),avg(sal):多条数据，最终展示一个结果 多行函数</span></span><br></pre></td></tr></table></figure>



<h5 id="4-2-单行函数"><a href="#4-2-单行函数" class="headerlink" title="4.2 单行函数"></a>4.2 单行函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 单行函数包含:</span><br><span class="line"><span class="comment">-- 1.字符串函数</span></span><br><span class="line"><span class="keyword">select</span> ename,length( ename),<span class="built_in">substring</span>(ename,<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- substring字符串 截取，2:从字符下标为2开始，3:截取长度3 ( 下标从1开始)</span></span><br><span class="line"><span class="comment">-- 2.数值函数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>( <span class="number">-5</span>),<span class="built_in">CEIL</span>(<span class="number">5.3</span>), <span class="built_in">FLOOR</span>(<span class="number">5.9</span>),ROUND(<span class="number">3.14</span>) <span class="keyword">FROM</span> DUAL; <span class="comment">-- dual实际就是一个伪表</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-5</span>) 绝对值,<span class="built_in">CEIL</span>(<span class="number">5.3</span>) 向上取整,<span class="built_in">FLOOR</span>(<span class="number">5.9</span>) 向下取整, ROUND(<span class="number">3.14</span>) 四舍五入; <span class="comment">-- 如果没有where条件的话，from dual可以省略不写</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEIL</span>(sal) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">10</span><span class="operator">/</span><span class="number">3</span>, <span class="number">10</span><span class="operator">%</span><span class="number">3</span>, <span class="built_in">MOD</span>(<span class="number">10</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.日期与时间函数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> CURDATE(), CURTIME(); <span class="comment">-- curdate()年月日curtime()时分秒</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW(), SYSDATE(), SLEEP(<span class="number">3</span>) ,NOW(), SYSDATE() <span class="keyword">FROM</span> DUAL; <span class="comment">-- now(), sysdate() 年月日时分秒:</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">9999</span>, <span class="string">&#x27;lili&#x27;</span>, <span class="string">&#x27; SAL ASMAN&#x27;</span> , <span class="number">7698</span> , NOW() , <span class="number">1000</span>, nu1l, <span class="number">30</span>);</span><br><span class="line"><span class="comment">-- now()可以表示年月日时分秒，但是插入数据的时候还是要参照表的结构的</span></span><br><span class="line"><span class="keyword">DESC</span> emp;</span><br></pre></td></tr></table></figure>



<p><strong>流程函数 (If Switch)</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- if相关</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename , sal, IF(sal<span class="operator">&gt;=</span><span class="number">2500</span>, <span class="string">&#x27;高薪&#x27;</span>, <span class="string">&#x27;底薪&#x27;</span>) <span class="keyword">AS</span> <span class="string">&#x27;薪资等级&#x27;</span> <span class="keyword">FROM</span> emp; <span class="comment">-- if-else 双分支结构</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename , sal , comm, sal<span class="operator">+</span>IFNULL(comm,<span class="number">0</span>) <span class="keyword">FROM</span> emp; <span class="comment">-- 如果comm是null，那么取值为0 --单分支</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">NULLIF</span>(<span class="number">1</span>,<span class="number">1</span>) ,<span class="built_in">NULLIF</span>(<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">FROM</span> DUAL; <span class="comment">-- 如果value1等于value2，则返回null,否则返回value 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- case相关:</span></span><br><span class="line"><span class="comment">-- case等值判断</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename ,job,</span><br><span class="line"><span class="keyword">CASE</span> job</span><br><span class="line">	<span class="keyword">WHEN</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">THEN</span><span class="string">&#x27;店员&#x27;</span></span><br><span class="line">	<span class="keyword">WHEN</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;销售&#x27;</span></span><br><span class="line">	<span class="keyword">WHEN</span> <span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;经理&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;其他&#x27;</span></span><br><span class="line"><span class="keyword">END</span> <span class="string">&#x27;岗位&#x27;</span>,</span><br><span class="line">sal <span class="keyword">FROM</span> emp; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- case区间判断:</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, sal,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">	<span class="keyword">WHEN</span> sal<span class="operator">&lt;=</span><span class="number">1000</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">	<span class="keyword">WHEN</span> sal<span class="operator">&lt;=</span><span class="number">2000</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">	<span class="keyword">WHEN</span> sal<span class="operator">&lt;=</span><span class="number">3000</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">END</span> <span class="string">&#x27;工资等级&#x27;</span>,</span><br><span class="line">deptno <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>



<p><strong>其它函数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看当前使用的数据库</span></span><br><span class="line"><span class="keyword">SELECT</span> DATABASE(), <span class="keyword">USER</span>(),VERSION() <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h5 id="4-4-多行函数"><a href="#4-4-多行函数" class="headerlink" title="4.4 多行函数"></a>4.4 多行函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多行函数:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) ,<span class="built_in">MIN</span>(sal), <span class="built_in">COUNT</span>(sal), <span class="built_in">SUM</span>(sal), <span class="built_in">SUM</span>(sal)<span class="operator">/</span><span class="built_in">COUNT</span>(sal),<span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 多行函数自动忽略 null 值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>( Comm) , <span class="built_in">MIN</span>( comm),<span class="built_in">COUNT</span>( comm) , <span class="built_in">SUM</span>( comm),<span class="built_in">SUM</span>( comm) , <span class="built_in">COUNT</span>(comm) , <span class="built_in">AVG</span>(comm) <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">-- max() ,min() , count()针对所有类型  sum(),avg() 只针对数值型类型有效</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(ename) ,<span class="built_in">MIN</span>(ename) , <span class="built_in">COUNT</span>(ename) , <span class="built_in">SUM</span>( ename ) , <span class="built_in">AVG</span>(ename) <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- count --计数</span></span><br><span class="line"><span class="comment">-- 统计表的记录数:方式1:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(ename) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 统计表的记录数:方式2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>



<h5 id="4-5-分组-group-by"><a href="#4-5-分组-group-by" class="headerlink" title="4.5 分组 group by"></a>4.5 分组 group by</h5><p>group by : 用来进行分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计各个部门门的平均工资</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp; <span class="comment">-- 字段和多行函数不可以同时使用</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno; <span class="comment">-- 字段和多行函数不可以同时使用,除非这个字段属于分组</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 统计各个岗位的平均工资:</span></span><br><span class="line"><span class="keyword">SELECT</span> job,<span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br><span class="line"><span class="keyword">SELECT</span> job, <span class="built_in">LOWER</span>(job),<span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>



<h5 id="4-6-having-分组后筛选"><a href="#4-6-having-分组后筛选" class="headerlink" title="4.6 having 分组后筛选"></a>4.6 having 分组后筛选</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计各个部门的平均工资, 只显示平均工资2000以上的- 分组以后进行二次筛选having</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(sal) <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">AVG</span>(sal)平均工资 <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span> 平均工资<span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">AVG</span>(sal)平均工资 <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span> 平均工资<span class="operator">&gt;</span> <span class="number">2000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 统计各个岗位的平均工资,除了MANAGER</span></span><br><span class="line"><span class="comment">-- 方法1:</span></span><br><span class="line"><span class="keyword">SELECT</span> job, <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">!=</span> <span class="string">&#x27; MANAGER&#x27;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br><span class="line"><span class="comment">-- 方法2:</span></span><br><span class="line"><span class="keyword">SELECT</span> job, <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> job <span class="keyword">HAVING</span> job <span class="operator">!=</span> <span class="string">&#x27;MANAGER&#x27;</span>;</span><br><span class="line"><span class="comment">-- where在分组前进行过滤的，having在分组后进行后滤。</span></span><br></pre></td></tr></table></figure>



<h5 id="4-7-单表查询总结"><a href="#4-7-单表查询总结" class="headerlink" title="4.7 单表查询总结"></a>4.7 单表查询总结</h5><ul>
<li><p>select语句的执行顺序<br>from– where – group by- select - having- order by</p>
</li>
<li><p>单表查询练习</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列出工资最小值小于2000的职位</span></span><br><span class="line"><span class="keyword">SELECT</span> job, <span class="built_in">MIN</span>(sal)</span><br><span class="line">	<span class="keyword">FROM</span> emp</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> job</span><br><span class="line">	<span class="keyword">HAVING</span> <span class="built_in">MIN</span>(sal) <span class="operator">&lt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="comment">-- 列出平均工资大于1200元的部门和工作搭配组合I</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno,job, <span class="built_in">AVG</span>(sal)</span><br><span class="line">	<span class="keyword">FROM</span> emp</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno,job</span><br><span class="line">	<span class="keyword">HAVING</span> <span class="built_in">AVG</span>(sal)<span class="operator">&gt;</span><span class="number">1200</span></span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno;</span><br><span class="line"><span class="comment">-- 统计[人数小于4的]部门的平均工资。</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">COUNT</span>(<span class="number">1</span>),<span class="built_in">AVG</span>(sal )</span><br><span class="line">	<span class="keyword">FROM</span> emp</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">	<span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="operator">&lt;</span> <span class="number">4</span>;</span><br><span class="line"><span class="comment">-- 统计各部门的最高工资，排除最高工资小于3000的部门。</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno, <span class="built_in">MAX</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MAX</span>(sal) <span class="operator">&lt;</span> <span class="number">3000</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="五-多表查询"><a href="#五-多表查询" class="headerlink" title="五 多表查询"></a>五 多表查询</h4><h5 id="5-1-内连接"><a href="#5-1-内连接" class="headerlink" title="5.1 内连接"></a>5.1 内连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号，姓名，部门编号,部门名称:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp; <span class="comment">-- 14条记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept; <span class="comment">-- 4条记录</span></span><br><span class="line"><span class="comment">-- 多表查询:</span></span><br><span class="line"><span class="comment">-- 交叉连接 : cross join</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> dept; <span class="comment">-- 14*4 = 56条 笛卡尔乘积:没有实际意义， 有理论意义</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">JOIN</span> dept; <span class="comment">-- cross 可以省略不写，mysq1中可以，oracle中不可以</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自然连接: natural join</span></span><br><span class="line"><span class="comment">-- 优点:自动匹配所有的同名列,同名列只展示一次，简单</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> empno , ename, sal, dname , loc</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> dept;</span><br><span class="line"><span class="comment">-- 缺点: 查询字段的时候，没有指定字段所属的数据库表，效率低</span></span><br><span class="line"><span class="comment">-- 解决:指定表名:</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.empno , emp.ename, emp.sal, dept.dname , dept.loc, dept.deptno</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 缺点:表名太长</span></span><br><span class="line"><span class="comment">-- 解决:表起别名</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.sal,d.dname ,d.loc ,d.deptno</span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> dept d;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自然连接natural join缺点:自动匹配表中所有的同名列，但是有时候我们希望只匹配部分同名列: </span></span><br><span class="line"><span class="comment">-- 解决: 内连接- using子句:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d 	<span class="comment">-- inner可以不写</span></span><br><span class="line"><span class="keyword">USING</span>(deptno); 		<span class="comment">-- 这里不能写natural join了,这里是内连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- using缺点:关联的字段，必须是同名的</span></span><br><span class="line"><span class="comment">-- 解决:内连接 - on子句: </span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> (e.deptno <span class="operator">=</span> d. deptno);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 多表连接查询的类型: 1.交叉连接 cross join 2.自然连接natural join</span></span><br><span class="line"><span class="comment">-- 3.内连接- using子句 4.内连接- on子句</span></span><br><span class="line"><span class="comment">-- 综合看:内连接- on子句</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> (e.deptno <span class="operator">=</span> d. deptno)</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">3500</span>;</span><br><span class="line"><span class="comment">-- 条件:</span></span><br><span class="line"><span class="comment">-- 1.筛选条件where</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="comment">-- 2.连接条件on, using, natural</span></span><br><span class="line"><span class="comment">-- SQL99语法 :筛选条件和连接条件是分开的</span></span><br></pre></td></tr></table></figure>



<h5 id="5-2-外连接"><a href="#5-2-外连接" class="headerlink" title="5.2 外连接"></a>5.2 外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- inner join一on子句: 显示的是所有匹配的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d </span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept;</span><br><span class="line"><span class="comment">-- 问题:</span></span><br><span class="line"><span class="comment">-- 1.40号部分没有员工，没有显示在查询结果中</span></span><br><span class="line"><span class="comment">-- 2.员工scott没有部门，没有显示在查询结果中</span></span><br><span class="line"><span class="comment">-- 外连接:除了显示匹配的数据之外，还可以显示不匹配的数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左外连接: left outer join -- 左面的那个表的信息，即使不匹配也可以查看出效果</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右外连接: right outer join</span></span><br><span class="line"><span class="comment">-- 右面的那个表的信息，即使不匹配也可以查看出效果</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全外连接full outer join --这个语法在mysq1中不支持， 在oracle中支持 -- 展示左，右表全部不匹配的数据</span></span><br><span class="line"><span class="comment">-- scott ，40号部门都可以看到</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 解决mysq1中不支持全外连接的问题:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line"><span class="keyword">UNION</span> <span class="comment">-- 并集</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- outer 可以省略不写</span></span><br></pre></td></tr></table></figure>



<h5 id="5-3-三表查询"><a href="#5-3-三表查询" class="headerlink" title="5.3 三表查询"></a>5.3 三表查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> salgrade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.`DEPTNO` <span class="operator">=</span> d.`DEPTNO`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e. ename,e. sal,e. empno,e. deptno,d. dname,s.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d. deptno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> salgrade s</span><br><span class="line"><span class="keyword">ON</span> e.sal <span class="keyword">BETWEEN</span> s.losal <span class="keyword">AND</span> s. hisal;</span><br></pre></td></tr></table></figure>



<h5 id="5-4-自连接"><a href="#5-4-自连接" class="headerlink" title="5.4 自连接"></a>5.4 自连接</h5><img src="/2022/12/20/MySQL/image-20221209173931160.png" alt="image-20221209173931160" style="zoom:200%;">

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号、姓名、上级编号，上级的姓名</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e1.`EMPNO` 员工编号,e1.ename 员工姓名,e1.`MGR` 领导编号,e2.`ENAME` 员工领导姓名</span><br><span class="line"><span class="keyword">FROM</span> emp e1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> emp e2</span><br><span class="line"><span class="keyword">ON</span> e1.`MGR` <span class="operator">=</span> e2.empno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左外连接</span></span><br><span class="line"><span class="keyword">SELECT</span> e1.`EMPNO` 员工编号,e1.ename 员工姓名,e1.`MGR` 领导编号,e2.`ENAME` 员工领导姓名</span><br><span class="line"><span class="keyword">FROM</span> emp e1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e2</span><br><span class="line"><span class="keyword">ON</span> e1.`MGR` <span class="operator">=</span> e2.empno;</span><br></pre></td></tr></table></figure>



<h5 id="5-5-多表查询92语法"><a href="#5-5-多表查询92语法" class="headerlink" title="5.5 多表查询92语法"></a>5.5 多表查询92语法</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称:</span></span><br><span class="line"><span class="keyword">SELECT</span> e. empno, e. ename,e. sal, e. deptno, d. dname</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="comment">-- 相当于99语法中的cross join ,出现笛卡尔积，没有意义</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno, e.ename,e.sal, e.deptno, d.dname</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- 相当于99语法中的natural join</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于2000的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno <span class="operator">=</span> d.deptno <span class="keyword">AND</span> e.sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工的名字，岗位，上级编号，上级名称(自连接) :</span></span><br><span class="line"><span class="keyword">SELECT</span> e1.ename, e1.job,e1.mgr,e2.ename</span><br><span class="line"><span class="keyword">FROM</span> emp e1,emp e2</span><br><span class="line"><span class="keyword">WHERE</span> e1.mgr <span class="operator">=</span> e2.empno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.sal,e.deptno,d.dname,s.grade</span><br><span class="line"><span class="keyword">FROM</span> emp e, dept d, salgrade s</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno <span class="operator">=</span> d.deptno <span class="keyword">AND</span> e.sal <span class="operator">&gt;=</span> s.losal <span class="keyword">AND</span> e.sal <span class="operator">&lt;=</span> s.hisal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 总结:</span></span><br><span class="line"><span class="comment">-- 1.92语法麻烦</span></span><br><span class="line"><span class="comment">-- 2.92语法中 表的连接条件和筛选条件是放在- -起的没有分开</span></span><br><span class="line"><span class="comment">-- 3.99语法中提供了更多的查询连接类型: cross, natural, inner,outer</span></span><br></pre></td></tr></table></figure>



<h5 id="5-6-子查询"><a href="#5-6-子查询" class="headerlink" title="5.6 子查询"></a>5.6 子查询</h5><ul>
<li><p>什么是子查询?</p>
<p>一条SQL语句含有多个select</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 引入子查询:</span></span><br><span class="line"><span class="comment">-- 查询所有比&quot;CLARK&quot;工资高的员工的信息</span></span><br><span class="line"><span class="comment">-- 步骤1:&quot;CLARK&quot; 工资</span></span><br><span class="line"><span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span><span class="string">&#x27;CLARK&#x27;</span>; <span class="comment">-- 2450</span></span><br><span class="line"><span class="comment">-- 步骤2:查询所有工资比2450高的员工的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">2450</span>;</span><br><span class="line"><span class="comment">-- 两次命令解决问题--》效率低，第二个命令依托于第一个命令，第一个命令的结果给第二个命令使用，但是</span></span><br><span class="line"><span class="comment">-- 因为第一个命令的结果可能不确定要改，所以第二个命令也会导致修改</span></span><br><span class="line"><span class="comment">-- 将步骤1和步骤2合并--》 子查询: </span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;CLARK&#x27;</span>);</span><br><span class="line"><span class="comment">-- 一个命令解决问题--》效率高</span></span><br></pre></td></tr></table></figure></li>
<li><p>执行顺序:</p>
<p>先执行子查询 , 再执行外查询;</p>
</li>
<li><p>不相关子查询:</p>
<p>子查询可以独立运行 , 称为不相关子查询。</p>
</li>
<li><p>不相关子查询分类:</p>
<p>根据子查询的结果行数, 可以分为单行子查询和多行子查询。</p>
</li>
</ul>
<h6 id="5-6-1-单行子查询"><a href="#5-6-1-单行子查询" class="headerlink" title="5.6.1 单行子查询"></a>5.6.1 单行子查询</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行子查询: 查询工资高于平均工资的雇员名字和工资。</span></span><br><span class="line"><span class="keyword">SELECT</span> ename, sal</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询和CLARK同- - 部门且比他工资低的雇员名字和工资。</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> (<span class="keyword">SELECT</span> deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;CLARK&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">sal <span class="operator">&lt;</span> (<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;CLARK&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询职务和SCOTT相同，比SCOTT雇佣时间早的雇员信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job <span class="operator">=</span> (<span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span></span><br><span class="line"><span class="string">&#x27;SCOTT&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">hiredate <span class="operator">&lt;</span> (<span class="keyword">SELECT</span> hiredate <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;SCOTT&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h6 id="5-6-2-多行子查询"><a href="#5-6-2-多行子查询" class="headerlink" title="5.6.2 多行子查询"></a>5.6.2 多行子查询</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多行子查询:</span></span><br><span class="line"><span class="comment">-- [1]查询[部门20中职务同部门10的雇员一-样的]雇员信息。</span></span><br><span class="line"><span class="comment">-- 查询雇员信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp ;</span><br><span class="line"><span class="comment">-- 查询部门20中的雇员信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span>; <span class="comment">-- CLERK , MANAGER , ANALYST</span></span><br><span class="line"><span class="comment">-- 部门10的雇员的职务:</span></span><br><span class="line"><span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>; <span class="comment">-- MANAGER, PRESIDENT , CLERK</span></span><br><span class="line"><span class="comment">-- 查询部门20中职务同部门10的雇员一-样的雇员信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">AND</span> job<span class="operator">=</span> (<span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>); </span><br><span class="line"><span class="comment">-- &gt; Subquery returns more than 1 row</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">AND</span> job <span class="keyword">IN</span> (<span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"># 或者</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">AND</span> job <span class="operator">=</span> <span class="keyword">ANY</span> (<span class="keyword">SELECT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- [2]查询工资比所有的“SALESMAN&quot;都高的雇员的编号、名字和工资。</span></span><br><span class="line"><span class="comment">-- 查询雇员的编号、名字和工资</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename,sal <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="comment">-- &quot;SALESMAN&quot;的工 资:</span></span><br><span class="line"><span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span></span><br><span class="line"><span class="comment">-- 多行子查询:</span></span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,sal</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>);</span><br><span class="line"><span class="comment">-- 单行子查询:</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename,sal</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- [3]查询工资低于任意一个“CLERK&quot;的工资的雇员信息。</span></span><br><span class="line"><span class="comment">-- 查询雇员信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 查询工资低于任意一个“CLERK”的工资的雇员信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&lt;</span> <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span> job <span class="operator">!=</span> <span class="string">&#x27;CLERK&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 单行子查询:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&lt;</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span> job <span class="operator">!=</span> <span class="string">&#x27;CLERK&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h6 id="5-6-3-相关子查询"><a href="#5-6-3-相关子查询" class="headerlink" title="5.6.3 相关子查询"></a>5.6.3 相关子查询</h6><ol>
<li>不相关的子查询引入:<ol>
<li>不相关的子查询:子查询可以独立运行，先运行子查询，再运行外查询。</li>
<li>相关子查询:子查询不可以独立运行，并且先运行外查询,再运行子查询</li>
</ol>
</li>
<li>不相关的子查询优缺点:<ol>
<li>好处 : 简单功能强大(- -些使用不相关 子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现)</li>
<li>缺点 : 稍难理解</li>
</ol>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询最高工资的员工 (不相关子查询)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp);</span><br><span class="line"><span class="comment">-- 查询本部门最高工资的员工 (相关子查询)</span></span><br><span class="line"><span class="comment">-- 方法1:通过不相关子查询实现:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span> <span class="keyword">AND</span> sal <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">10</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span> <span class="keyword">AND</span> sal <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> sal <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">30</span>)</span><br><span class="line"><span class="comment">-- 缺点 : 语句比较多 , 具体到底有多少个部分未知</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法2 : 相关子查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="operator">=</span> e.deptno) <span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询工资高于其所在岗位的平均工资的那些员工 (相关子查询)</span></span><br><span class="line"><span class="comment">-- 不相关子查询:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">AND</span> sal <span class="operator">&gt;=</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span> .....</span><br><span class="line"><span class="comment">-- 相关子查询:</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> sal <span class="operator">&gt;=</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal) <span class="keyword">FROM</span> emp e2 <span class="keyword">WHERE</span> e2.job <span class="operator">=</span> e.job);</span><br></pre></td></tr></table></figure>



<h4 id="六-事务"><a href="#六-事务" class="headerlink" title="六 事务"></a>六 事务</h4><p>事务 (Transaction) 是用来维护数据库完整性的，它能够保证一系列的MySQL操作要么全部执行， 要么全不执行。</p>
<p>例子1:<br>举一个例子来进行说明，例如转账操作: A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行;如果其中一 个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一 致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。<br>例子2:<br>在淘宝购物下订单的时候，商家库存要减少,订单增加记录,付款我的账号少100元..操作要么全部执行，要么全不执行。</p>
<ul>
<li>事务的概念<br>事务(Transaction) 指的是一个操作序列, 该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由DBMS (数据库管理系统)中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有<strong>InnoDB</strong> (MySQL5.5以后默认的存储引擎)和MylSAM (MySQL5.5之前默认的存储引擎)，其中<code>InnoDB</code>支持事务处理机制，而MyISAM不支持。</li>
<li>事务的特性<br>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一 个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的原子性(Atomicity)、一致性(Consistency)、隔离性(Isolation) 和持久性(Durability) 。这四个特性简称为ACID特性。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建账户表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> account(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	uname <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	balance <span class="keyword">DOUBLE</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 查看账户表</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在表中插入数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> account <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;丽丽&#x27;</span>,<span class="number">2000</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 丽丽给小刚转200元:</span></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 默认一个ML语句是一个事务，所以上面的操作执行了2个事务。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 必须让上面的两个操作控制在一个事务中:</span></span><br><span class="line"><span class="comment">-- 手动开启事务:</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 手动回滚 : 刚才执行的操作全部取消</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 手动提交:</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在回滚和提交之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</span></span><br></pre></td></tr></table></figure>



<h5 id="6-1-事务的并发问题"><a href="#6-1-事务的并发问题" class="headerlink" title="6.1 事务的并发问题"></a>6.1 事务的并发问题</h5><ul>
<li><p>脏读(Dirty read)<br>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中,这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</p>
</li>
<li><p>不可重复读(Unrepeatableread) : </p>
<p>指在一个事务内多次读同一 数据。在这个事务还没有结束时，另一个事务也访问该数据。那么,在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太-一样。这就发生了在一个事务内两次读到的数据是不一样的情况， 因此称为不可重复读。</p>
</li>
<li><p>幻读 (Phantom read) :</p>
<p>幻读与不可重复读类似。它发生在一个事务(T1) 读取了几行数据,接着另-一个并发事务(T2) 插入了一些数据时。<br>在随后的查询中，第一个事务(T1) 就会发现多了一-些原本不存在的记录，就好像发生了幻觉一样,所以称为幻读。</p>
</li>
</ul>
<p><strong>不可重复度和幻读区别:</strong><br>不可重复读的重点是修改，幻读的重点在于新增或者删除。</p>
<p>解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</p>
<h5 id="6-2-事务的隔离级别"><a href="#6-2-事务的隔离级别" class="headerlink" title="6.2 事务的隔离级别"></a>6.2 事务的隔离级别</h5><p>事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以MySQL中提供了四种隔离级别来解决上述问题。<br>事务的隔离级别从低到高依次为<code>READ UNCOMMITTED</code>、<code>READ COMMITTED</code>、<code>REPEATABLE READ</code>以及<code>SERIALIZABLE</code>,隔离级别越低，越能支持高并发的数据库操作。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看默认的事务隔离级别MySQL默 认的是repeatable read</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@transaction</span>_isolation;</span><br><span class="line"><span class="comment">-- 设置事务的隔离级别(设置当前会话的隔离级别)</span></span><br><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</span><br><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;</span><br><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;</span><br><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL SERIALIZABLE;</span><br></pre></td></tr></table></figure>



<h4 id="七-视图"><a href="#七-视图" class="headerlink" title="七 视图"></a>七 视图</h4><ol>
<li>视图的概念<br>视图(view) 是-个从单张或多张基础数据表或其他视图中构建出来的虚拟表。同基础表一样,视图中也包含了一系列带有名称的列和行数据,但是数据库中只是存放视图的定义，也就是动态检索数据的查询语句，而并不存放视图中的数据，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图时才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据依赖于构建视图的基础表,如果基本表中的数据发生了变化，视图中相应的数据也会跟着改变。<br><strong>PS:</strong> 视图本质上就是: -个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的sq语句</li>
<li>视图的好处<br>简化用户操作:视图可以使用户将注意力集中在所关心地数据上,而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。<br>对机密数据提供安全保护:有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据(如，敏感字段”salary” )出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建单表视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myview01</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,job,deptno</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看视图</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myview01;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在视图中插入数据:</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myview01 ( empno , ename , job , deptno) <span class="keyword">VALUES</span> (<span class="number">9999</span>, <span class="string">&#x27;lili&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myview01 ( empno , ename , job , deptno) <span class="keyword">VALUES</span> ( <span class="number">8888</span>, <span class="string">&#x27;nana&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span> ,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建单表视图:</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myview01</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, job, deptno</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myview01 ( empno, ename , job , deptno) <span class="keyword">VALUES</span> (<span class="number">7777</span>, <span class="string">&#x27;feifei&#x27;</span> , <span class="string">&#x27;CLERK&#x27;</span> ,<span class="number">30</span>);</span><br><span class="line"><span class="comment">-- 加入了 with check option 后 再添加不相关数据就报错了</span></span><br><span class="line"><span class="comment">-- &gt; 1369 - CHECK OPTION failed &#x27; mytestdb . myview01 &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建/替换多表视图:</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myview02</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.sal, d.deptno, d.dname</span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.deptno <span class="operator">=</span> d. deptno</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myview02;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建统计视图:</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myview03</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> e.deptno , d.dname , <span class="built_in">AVG</span>(sal) , <span class="built_in">MIN</span>(sal), <span class="built_in">COUNT</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">FROM</span> emp e</span><br><span class="line"><span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">USING</span>(deptno)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> e.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myview03 ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建基于视图的视图:</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myview04</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myview03 <span class="keyword">WHERE</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myview04;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"># 编程</a>
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/12/07/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/" rel="prev" title="第一篇文章">
                  <i class="fa fa-chevron-left"></i> 第一篇文章
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/12/25/SSM%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88/" rel="next" title="SSM框架整合">
                  SSM框架整合 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2022 - 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">猫尛妖</span>
</div>
  <div class="powered-by">
   本站已安全运行:
	<span id="momk"></span>
	<script language=javascript>
	function show_date_time(){
		window.setTimeout("show_date_time()", 1000);
		BirthDay=new Date("12-07-2022 10:48:24");//建站日期
		today=new Date();
		timeold=(today.getTime()-BirthDay.getTime());
		sectimeold=timeold/1000
		secondsold=Math.floor(sectimeold);
		msPerDay=24*60*60*1000
		e_daysold=timeold/msPerDay
		daysold=Math.floor(e_daysold);
		e_hrsold=(daysold-e_daysold)*-24;
		hrsold=Math.floor(e_hrsold);
		e_minsold=(hrsold-e_hrsold)*-60;
		minsold=Math.floor((hrsold-e_hrsold)*-60);
		seconds=Math.floor((minsold-e_minsold)*-60);
		momk.innerHTML=daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒" ;
	}
show_date_time();
</script>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  





</body>
</html>
